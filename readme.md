# Проект - Консольное приложение для работы с вакансиями с сайта hh.ru. 
    
Программа позволяет:

* создавать базу данных и таблицы для хранения информации о работодателях и вакансиях;
 
* получать список компаний с количеством вакансий;
 
* просматривать все доступные вакансии (Ограничение API: не более 2000 вакансий);
 
* рассчитывать среднюю зарплату по вакансиям;
 
* находить вакансии с зарплатой выше средней;
 
* искать вакансии по ключевым словам.


## Cтатус разработки: 

в разработке


## Зависимости
• Python 3.x

• Все библиотеки, которые использованы в проекте указаны в **requirements.txt**


## Установка:

1 Клонируйте репозиторий:
``` git clone git@github.com:lidiar8r-ops/coursework_2.git  ```

2 Перейдите в папку проекта:
``` cd ваш_репозиторий```

3 Установите зависимости:
``` pip install -r requirements.txt```

4 Настройте конфигурационные файлЫ:

* **src/config.py** — укажите  код области для выборки area_hh по умолчанию равен  104  Челябинск (Москва = 1).
Примечания

    Для работы с hh.ru используется публичное API, поэтому дополнительные ключи авторизации не требуются.

    База данных создаётся автоматически при выборе пункта 1 главного меню.

    Приложение рассчитано на работу с PostgreSQL, но может быть адаптировано для других СУБД с минимальными изменениями.

    Убедитесь, что директории для логов  **logs** доступна для записи.

* **database.ini** - укажите параметры подключения к вашей базе данных PostgreSQL 
    (пример заполнения находится в файле database_example.ini):

    [postgresql]
    host=localhost 
    user=postgres 
    password=пароль для подключения к БД
    port=5432

6 Запуск

Выполните скрипт:
```python main.py```

####

### Консоль программы

Приложение запустит интерактивное меню в консоли:

```
Добро пожаловать в систему поиска вакансий!
==================================================

Выберите действие:
1. Создание БД и таблицы для хранения данных о работодателях и вакансиях
2. Список всех компаний и количество вакансий у каждой
3. Список всех вакансий
4. Средняя зарплата по всем вакансиям
5. Список вакансий с зарплатой выше средней
6. Список вакансий по ключевым словам
7. Выход

Введите номер действия (1–7): 
```

<details>
  <summary> Описание пунктов меню (Нажмите, чтобы раскрыть)</summary>
1. Создание БД и таблицы — создаёт базу данных и таблицы, загружает данные о вакансиях из hh.ru для указанных работодателей.

2. Список всех компаний и количество вакансий — выводит список компаний с указанием количества вакансий у каждой.

3. Список всех вакансий — показывает все вакансии (компания, название, зарплата, ссылка).

4. Средняя зарплата по всем вакансиям — рассчитывает и выводит среднюю зарплату.

5. Список вакансий с зарплатой выше средней — выводит вакансии, где зарплата превышает среднюю.
 
6. Список вакансий по ключевым словам — ищет вакансии по заданным ключевым словам (например, «программист», «python»).
 
7. Выход — завершает работу приложения.
</details>
  

#### Пример работы
``` 
    Выберите пункт 1 для создания БД и загрузки данных.

    После успешного создания БД выберите другие пункты меню для анализа данных.

    Для поиска вакансий по ключевым словам выберите пункт 6 и введите слова через запятую (например, python, разработчик).
```


### Структура проекта

Проект организован следующим образом:
```
src/
├── app_logger.py           # Модуль для настройки логирования
├── config.py               # Модуль с конфигурацией (настройки БД и др.)
├── db_manager.py           # Класс для работы с базой данных
├── utils.py                # Вспомогательные функции (получение данных с hh.ru, создание БД и т. д.)
database.ini                # Вспомогательный файл с настройками подключения к БД PostgreSql
main.py                     # Основной скрипт приложения
```


### 1. Модуль db_manager

Назначение: 

* Модуль реализует класс DBManager для взаимодействия с базой данных PostgreSQL в системе поиска вакансий. 

* Обеспечивает операции с данными о работодателях и вакансиях, а также бизнес‑логику запросов (средняя зарплата, 
поиск по ключевым словам и т. д.).

<details>
  <summary> Основные классы (Нажмите, чтобы раскрыть)</summary>

Абстрактный базовый класс DBClass

        Назначение: задаёт общий интерфейс для работы с БД.

        Ключевые методы:

            __init__() — инициализирует параметры подключения.

            close_conn() — закрывает соединение с БД.

Класс DBManager (наследует DBClass)

        Назначение: конкретная реализация работы с БД для системы вакансий.

        Особенности:

            Проверяет существование БД при инициализации.

            Автоматически устанавливает соединение.

            Обрабатывает ошибки через логирование (logger).
    

</details>

<details>
  <summary>Ключевые методы (Нажмите, чтобы раскрыть)</summary>

* _database_exists()

    Проверяет, существует ли указанная БД в кластере PostgreSQL.

    Возвращает: True/False.

* print_vacancies()

    Форматирует и выводит список вакансий в консоль (номер, компания, название, зарплата, ссылка).

* get_companies_and_vacancies_count()

    Получает список компаний с количеством вакансий у каждой.

* get_all_vacancies()

  Возвращает все вакансии с деталями: компания, название, диапазон зарплаты, ссылка.

* get_avg_salary()

    Рассчитывает среднюю зарплату по всем вакансиям (с округлением до 2 знаков).

* get_vacancies_with_higher_salary()
  
    Находит вакансии с зарплатой выше средней. Использует результат get_avg_salary().

* get_vacancies_with_keyword()

    Ищет вакансии по ключевым словам (например, «python»).
  
  Особенности:

      Поддерживает ввод строки с запятыми или списка слов.

      Использует LIKE с регистронезависимым поиском (UPPER).

      Объединяет условия через OR
</details>


### 2. Модуль utils

Модуль содержит вспомогательные функции для работы с API hh.ru и базой данных PostgreSQL в системе поиска вакансий.

<details>
  <summary>Ключевые методы (Нажмите, чтобы раскрыть)</summary>
*get_hh_data(employer_ids)

        Назначение: получает данные о компаниях и их вакансиях через API hh.ru.

        Логика:

            Для каждого employer_id запрашивает информацию о компании.

            Загружает вакансии постранично (до 100 на страницу, максимум 2000 вакансий).

            Собирает данные в структуру: {"employer": данные_компании, "vacansies": список_вакансий}.

        Обработка ошибок: логирует исключения, пропускает некорректные ответы.

        Возвращает: список словарей с данными.

* create_database(database_name, params)

        Назначение: создаёт БД и таблицы для хранения данных.
        
        Особенности: обрабатывает ошибки (например, занятую БД) через pg_terminate_backend.

* save_data_to_database(data, database_name, params)

        Назначение: сохраняет полученные данные в БД.

        Защита: проверяет существование таблиц перед записью.

</details>


### 4. Модуль main (интерфейс)

Назначение: интерактивное взаимодействие с пользователем.

<details>
  <summary> Функционал (Нажмите, чтобы раскрыть)</summary>
    main() -  запуск консольного приложения
</details>



### Логирование

Все модули используют единый механизм логирования через app_logger. Логируются:

    начало/конец работы;

    выполнение действий (поиск, сохранение, удаление);

    ошибки ввода и API‑запросов;

    результаты операций.

Обработка ошибок

    Некорректный ввод — сообщение пользователю.

    Отсутствие результатов — уведомление.

    Ошибки API — логгирование, показ сообщения.

    Проблемы с подключением к БД — логгирование, показ сообщения, продолжение работы.


## Цель разработки: 

Курсовая работа на Python  


## Автор
[@lidiar8r-ops](https://github.com/lidiar8r-ops)


Версия: 1.0
Дата: 2026-01-20